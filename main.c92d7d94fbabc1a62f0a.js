(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{HVwC:function(e,t,n){},L1EO:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("L1EO"),n("HVwC"),n("JBxO"),n("FdtR"),n("QDHd");var a=n("uTJt"),l=n.n(a),o={page:1,apiKey:"89b9004c084fb7d0e8ffaadd17cb8254",total:0,getOneMovieInfo:function(e){var t="https://api.themoviedb.org/3/movie/"+e+"?api_key="+this.apiKey+"&language=en-US";return fetch(t).then((function(e){return e.json()}))},getPopularMovies:function(e){var t="https://api.themoviedb.org/3/movie/popular?api_key="+this.apiKey+"&language=en-US&page="+e+"&";return fetch(t).then((function(e){return e.json()}))},getMoviesBySearch:function(e){var t="https://api.themoviedb.org/3/search/movie?api_key="+this.apiKey+"&language=en-US&query="+e+"&page=1";return fetch(t).then((function(e){return e.json()}))},getGenre:function(){var e="https://api.themoviedb.org/3/genre/movie/list?api_key="+this.apiKey+"&language=en-US";return fetch(e).then((function(e){return e.json()})).then((function(e){return e.genres}))}},i={header:document.querySelector(".header"),nav:document.querySelector(".nav"),logo:document.querySelector(".logo"),home:document.querySelector("#home"),myLib:document.querySelector("#lib"),searchBox:document.querySelector(".search-box"),input:document.querySelector("#input"),notification:document.querySelector("#notification"),btnBox:document.querySelector(".btn-box"),gallery:document.querySelector(".movies-list"),container:document.querySelector(".container"),spinner:document.querySelector(".spinner-border"),error:document.querySelector("#error"),modal:document.querySelector("[data-modal]"),closeModalBtn:document.querySelector("[data-modal-close]"),movieCard:document.querySelector(".movie-card"),modalLib:document.querySelector("#modal-lib"),watchedBtn:document.querySelector("#watched"),queueBtn:document.querySelector("#queue"),mainPaginationContainer:document.getElementById("tui-pagination-container"),watchedPaginationContainer:document.getElementById("tui-pagination-container-watched"),info:document.querySelector("#info"),libraryBtnClose:document.querySelector("#btn-library")};function r(){i.error.classList.remove("visually-hidden")}function c(){i.spinner.classList.add("visually-hidden")}function s(){i.spinner.classList.remove("visually-hidden"),i.error.classList.add("visually-hidden")}function u(){i.info.classList.add("visually-hidden")}var d,m,p;n("RtS0"),n("WB5j"),n("3dw1"),n("IlJM"),n("D/wG"),n("wcNg");function h(e,t,n,a,l,o,i){try{var r=e[o](i),c=r.value}catch(e){return void n(e)}r.done?t(c):Promise.resolve(c).then(a,l)}function f(e){return e.forEach((function(e){return e.genre_ids=function(e){for(var t="",n=function(n){var a=e[n];if(n>1&&e.length>3)return t+="Other","break";t+=d.find((function(e){return e.id===a})).name,(0===n&&e.length>1||1===n&&e.length>2)&&(t+=", ")},a=0;a<e.length;a++){if("break"===n(a))break}return t}(e.genre_ids)})),e.forEach((function(e){return e.release_date=e.release_date.slice(0,4)})),e}function v(e,t){for(var n=0;n<=t;n++)e.pop();return e}function g(e){u(),s(),o.getPopularMovies(e).then((function(e){y(v(f(e.results),7))})).catch((function(){return r()})).finally((function(){return c()}))}function y(e){i.gallery.innerHTML=l()(e)}(m=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getGenre();case 2:d=e.sent;case 3:case"end":return e.stop()}}),e)})),p=function(){var e=this,t=arguments;return new Promise((function(n,a){var l=m.apply(e,t);function o(e){h(l,n,a,o,i,"next",e)}function i(e){h(l,n,a,o,i,"throw",e)}o(void 0)}))},function(){return p.apply(this,arguments)})(),g(),i.input.addEventListener("change",(function(e){e.preventDefault();var t=e.target.value;if(0==t)return;e.target.value="",s(),i.mainPaginationContainer.classList.add("is-none-pagination"),o.getMoviesBySearch(t).then((function(e){var t=f(e.results);if(20===t.length&&(t=v(t,7)),t.length)return i.notification.classList.add("visually-hidden"),y(e.results);i.notification.classList.remove("visually-hidden")})).catch((function(){return r()})).finally((function(){return c()}))}));var b=g,w=function(){i.home.classList.add("menu-link--curent"),i.myLib.classList.remove("menu-link--curent"),i.header.classList.add("header-home"),i.header.classList.remove("header-lib"),i.btnBox.classList.add("visually-hidden"),i.searchBox.classList.remove("visually-hidden"),i.mainPaginationContainer.classList.remove("is-none-pagination"),i.watchedPaginationContainer.classList.add("is-none-pagination")},S=function(){i.home.classList.remove("menu-link--curent"),i.myLib.classList.add("menu-link--curent"),i.header.classList.remove("header-home"),i.header.classList.add("header-lib"),i.btnBox.classList.remove("visually-hidden"),i.searchBox.classList.add("visually-hidden"),i.mainPaginationContainer.classList.add("is-none-pagination"),i.watchedPaginationContainer.classList.remove("is-none-pagination")},L=function(){i.modal.classList.toggle("is-hidden")},q=n("2c84"),k=n.n(q);n("lUE2");var x=new k.a(i.mainPaginationContainer,{totalItems:1e4,itemsPerPage:20,visiblePages:5,page:1,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"});x.on("afterMove",(function(e){var t,n=e.page;b(n),t=250,setTimeout((function(){window.scrollTo({top:t+i.searchBox.clientHeight,behavior:"smooth"})}),500)}));var B=new k.a(i.watchedPaginationContainer,{totalItems:1,itemsPerPage:12,visiblePages:5,page:1,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"});B.on("afterMove",(function(e){var t=e.page;console.log("Я сообщаю текущую страницу пагинации для перерисовки следующего page в my library",t)}));n("iPZ8"),n("kypl"),n("pCzD"),n("4owi"),n("/YXa"),n("9UJh"),n("WoWj"),n("U00V");function O(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function C(e){i.gallery.innerHTML="",function(e){u();var t=JSON.parse(localStorage.getItem(e));n=t,0===n.length&&i.info.classList.remove("visually-hidden"),console.log(t),function(e){null!==e&&(B.setTotalItems(e.length),B.reset())}(t);var n;for(var a,r=function(){var e=a.value,t=[];o.getOneMovieInfo(e).then((function(e){t.push(e),i.gallery.insertAdjacentHTML("beforeend",l()(t))}))},c=O(t);!(a=c()).done;)r()}(e)}function _(){i.watchedBtn.classList.add("btn--accent"),i.queueBtn.classList.remove("btn--accent")}i.myLib.addEventListener("click",(function(){_(),C("add-watched"),i.libraryBtnClose.classList.remove("is-hidden-btn"),i.closeModalBtn.classList.add("is-hidden-btn")})),i.watchedBtn.addEventListener("click",(function(){return C("add-watched")})),i.queueBtn.addEventListener("click",(function(){return C("add-queue")})),i.queueBtn.addEventListener("click",(function(){i.watchedBtn.classList.remove("btn--accent"),i.queueBtn.classList.add("btn--accent")})),i.watchedBtn.addEventListener("click",(function(){_()}));var E={updateAccentBtn:_,updateMarkup:C,replaseBtnModal:function(){i.libraryBtnClose.classList.add("is-hidden-btn"),i.closeModalBtn.classList.remove("is-hidden-btn")}};i.nav.addEventListener("click",(function(e){e.preventDefault(),e.target===i.myLib?S():e.target===i.home&&(w(),b(),x.movePageTo(1),E.updateAccentBtn(),E.replaseBtnModal())})),i.logo.addEventListener("click",(function(e){e.preventDefault(),w(),b(),x.movePageTo(1),E.updateAccentBtn(),E.replaseBtnModal()})),i.modalLib.addEventListener("click",(function(e){e.preventDefault(),L(),S()})),window.addEventListener("keyup",(function(){"Escape"===event.key&&L()}));n("IvQZ"),n("uQK7"),n("Xlt+"),n("fp7Y"),n("4NM0");var M=n("dcBu"),I=(n("PzF0"),n("wiOx")),j=n.n(I);function N(e){s(),o.getOneMovieInfo(e).then((function(e){i.movieCard.innerHTML=j()([e]),function(e){var t=JSON.parse(localStorage.getItem("add-watched")),n=JSON.parse(localStorage.getItem("add-queue")),a=document.querySelector(".watch-btn"),l=document.querySelector(".queue-btn"),o=[];"number"==typeof t?o.push(t):"object"==typeof t&&o.push.apply(o,t);a.addEventListener("click",(function(t){"add to watched"===t.target.textContent?(o.push(e),localStorage.setItem("add-watched",JSON.stringify(o)),J(e)):'remove  "watched"'===t.target.textContent&&(o.splice(o.indexOf(e),1),localStorage.setItem("add-watched",JSON.stringify(o)),J(e),T("add-watched"))}));var i=[];"number"==typeof n?i.push(n):"object"==typeof n&&i.push.apply(i,n);l.addEventListener("click",(function(t){"add to queue"===t.target.textContent?(i.push(e),localStorage.setItem("add-queue",JSON.stringify(i)),J(e)):'remove  "queue"'===t.target.textContent&&(i.splice(i.indexOf(e),1),localStorage.setItem("add-queue",JSON.stringify(i)),J(e),T("add-queue"))}))}(e.id)})).catch((function(){return r()})).finally((function(){return c()}))}function J(e){var t=JSON.parse(localStorage.getItem("add-watched")),n=JSON.parse(localStorage.getItem("add-queue")),a=document.querySelector(".watch-btn"),l=document.querySelector(".queue-btn");null!==t&&("number"==typeof t&&t===Number(e)||"object"==typeof t&&t.includes(Number(e))?a.textContent='remove  "watched"':a.textContent="add to watched"),null!==n&&n.includes(Number(e))?l.textContent='remove  "queue"':l.textContent="add to queue"}function T(e){i.libraryBtnClose.addEventListener("click",(function(){E.updateMarkup(e)}))}i.gallery.addEventListener("click",(function(e){e.preventDefault();var t=e.target;if("UL"===t.nodeName)return;L(),N(t.dataset.id),setTimeout(J,500,t.dataset.id),n=t.dataset.id,fetch("https://api.themoviedb.org/3/movie/"+n+"/videos?api_key=89b9004c084fb7d0e8ffaadd17cb8254&language=en-US").then((function(e){return e.json()})).then((function(e){0===e.results.length&&(document.querySelector(".trailer-btn").style.display="none")}));var n})),document.querySelector(".movie-card").addEventListener("click",(function(e){if("trailer"===e.target.dataset.source){var t=e.srcElement.dataset.id;fetch("https://api.themoviedb.org/3/movie/"+t+"/videos?api_key=89b9004c084fb7d0e8ffaadd17cb8254&language=en-US").then((function(e){return e.json()})).then((function(e){var t=e.results[0].key;M.create("\n            <iframe allowFullScreen='allowFullScreen' src=\"https://www.youtube.com/embed/"+t+'" width="560" height="315" frameborder="0"></iframe>\n        ').show()}))}})),i.closeModalBtn.addEventListener("click",L),i.libraryBtnClose.addEventListener("click",L),null===localStorage.getItem("add-watched")&&localStorage.setItem("add-watched",JSON.stringify([])),null===localStorage.getItem("add-queue")&&localStorage.setItem("add-queue",JSON.stringify([]))},uTJt:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,l){var o,i,r=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,s="function",u=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="movies-list-item">\n  <div class="wrap">\n    '+(null!=(o=d(n,"if").call(r,null!=t?d(t,"poster_path"):t,{name:"if",hash:{},fn:e.program(2,l,0),inverse:e.program(4,l,0),data:l,loc:{start:{line:4,column:4},end:{line:10,column:11}}}))?o:"")+'  </div>\n  <h2 class="list-item-title" data-id="'+u(typeof(i=null!=(i=d(n,"id")||(null!=t?d(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:l,loc:{start:{line:12,column:39},end:{line:12,column:45}}}):i)+'">'+u(typeof(i=null!=(i=d(n,"title")||(null!=t?d(t,"title"):t))?i:c)===s?i.call(r,{name:"title",hash:{},data:l,loc:{start:{line:12,column:47},end:{line:12,column:56}}}):i)+'</h2>\n  <p class="list-item-descr" data-id="'+u(typeof(i=null!=(i=d(n,"id")||(null!=t?d(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:l,loc:{start:{line:13,column:38},end:{line:13,column:44}}}):i)+'">'+u(typeof(i=null!=(i=d(n,"genre_ids")||(null!=t?d(t,"genre_ids"):t))?i:c)===s?i.call(r,{name:"genre_ids",hash:{},data:l,loc:{start:{line:13,column:46},end:{line:13,column:59}}}):i)+" | "+u(typeof(i=null!=(i=d(n,"release_date")||(null!=t?d(t,"release_date"):t))?i:c)===s?i.call(r,{name:"release_date",hash:{},data:l,loc:{start:{line:13,column:62},end:{line:13,column:78}}}):i)+' <span class="list-item-vote_average">\n      '+u(typeof(i=null!=(i=d(n,"vote_average")||(null!=t?d(t,"vote_average"):t))?i:c)===s?i.call(r,{name:"vote_average",hash:{},data:l,loc:{start:{line:14,column:6},end:{line:14,column:22}}}):i)+" </span></p>\n</li>\n"},2:function(e,t,n,a,l){var o,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' <img class="list-item-img" src="https://image.tmdb.org/t/p/w300/'+c("function"==typeof(o=null!=(o=s(n,"poster_path")||(null!=t?s(t,"poster_path"):t))?o:r)?o.call(i,{name:"poster_path",hash:{},data:l,loc:{start:{line:4,column:88},end:{line:4,column:103}}}):o)+'" alt="Movie"\n      data-id="'+c("function"==typeof(o=null!=(o=s(n,"id")||(null!=t?s(t,"id"):t))?o:r)?o.call(i,{name:"id",hash:{},data:l,loc:{start:{line:5,column:15},end:{line:5,column:21}}}):o)+'" />\n'},4:function(e,t,n,a,l){var o,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <img class="list-item-img"\n      src="https://motivatevalmorgan.com/wp-content/uploads/2016/06/default-movie-1-1-300x450.jpg" alt="Movie"\n      data-id="'+e.escapeExpression("function"==typeof(o=null!=(o=i(n,"id")||(null!=t?i(t,"id"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"id",hash:{},data:l,loc:{start:{line:9,column:15},end:{line:9,column:21}}}):o)+'" />\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,l){var o;return null!=(o=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:0},end:{line:16,column:9}}}))?o:""},useData:!0})},wiOx:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,l){var o,i,r=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,s="function",u=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="card-box">\n    <div class="box-image">\n        <img class="one-movie-image" src="https://image.tmdb.org/t/p/w400/'+u(typeof(i=null!=(i=d(n,"poster_path")||(null!=t?d(t,"poster_path"):t))?i:c)===s?i.call(r,{name:"poster_path",hash:{},data:l,loc:{start:{line:4,column:74},end:{line:4,column:89}}}):i)+'" alt="Poster">\n    </div>\n    <div class="box-content">\n        <h2 class="content-title">'+u(typeof(i=null!=(i=d(n,"title")||(null!=t?d(t,"title"):t))?i:c)===s?i.call(r,{name:"title",hash:{},data:l,loc:{start:{line:7,column:34},end:{line:7,column:43}}}):i)+'</h2>\n        <ul class="content-list">\n            <li class="content-item">\n                <p class="item-part">Vote / Votes </p>\n                <span class="item-data item-data--accent">'+u(typeof(i=null!=(i=d(n,"vote_average")||(null!=t?d(t,"vote_average"):t))?i:c)===s?i.call(r,{name:"vote_average",hash:{},data:l,loc:{start:{line:11,column:58},end:{line:11,column:74}}}):i)+'</span><span> / </span>\n                <span class="item-data item-data--accent item-data--grey">'+u(typeof(i=null!=(i=d(n,"vote_count")||(null!=t?d(t,"vote_count"):t))?i:c)===s?i.call(r,{name:"vote_count",hash:{},data:l,loc:{start:{line:12,column:74},end:{line:12,column:88}}}):i)+'</span>\n            </li>\n            <li class="content-item">\n                <p class="item-part">Popularity</p> <span class="item-data">'+u(typeof(i=null!=(i=d(n,"popularity")||(null!=t?d(t,"popularity"):t))?i:c)===s?i.call(r,{name:"popularity",hash:{},data:l,loc:{start:{line:16,column:76},end:{line:16,column:90}}}):i)+'</span>\n\n            </li>\n            <li class="content-item">\n                <p class="item-part">Original Title</p> <span class="item-data">'+u(typeof(i=null!=(i=d(n,"original_title")||(null!=t?d(t,"original_title"):t))?i:c)===s?i.call(r,{name:"original_title",hash:{},data:l,loc:{start:{line:20,column:80},end:{line:20,column:98}}}):i)+'</span>\n\n            </li>\n            <li class="content-item">\n                <p class="item-part">Genre\n                <ul class="genre-list">\n'+(null!=(o=d(n,"each").call(r,null!=t?d(t,"genres"):t,{name:"each",hash:{},fn:e.program(2,l,0),inverse:e.noop,data:l,loc:{start:{line:26,column:20},end:{line:28,column:29}}}))?o:"")+'                </ul>\n                </p>\n\n            </li>\n        </ul>\n        <h3 class="title-text">About</h3>\n        <p class="text">'+u(typeof(i=null!=(i=d(n,"overview")||(null!=t?d(t,"overview"):t))?i:c)===s?i.call(r,{name:"overview",hash:{},data:l,loc:{start:{line:35,column:24},end:{line:35,column:36}}}):i)+'</p>\n        <div class="box-btn">\n            <button id="add-watched" class="btn watch-btn" data-source=\'add-watched\'>add to Watched</button>\n            <button id="add-queue" class="btn queue-btn" data-source=\'add-queue\'>add to queue</button>\n            <button id="trailer" data-id="'+u(typeof(i=null!=(i=d(n,"id")||(null!=t?d(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:l,loc:{start:{line:39,column:42},end:{line:39,column:48}}}):i)+'" class="btn trailer-btn" data-source=\'trailer\'>watch trailer</button>\n        </div>\n    </div>\n</div>\n'},2:function(e,t,n,a,l){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                    <li class="item-data genre-data">'+e.escapeExpression(e.lambda(null!=t?o(t,"name"):t,t))+"</li>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,l){var o;return null!=(o=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:0},end:{line:43,column:9}}}))?o:""},useData:!0})}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.c92d7d94fbabc1a62f0a.js.map