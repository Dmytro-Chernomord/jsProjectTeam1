(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{HVwC:function(e,t,n){},L1EO:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("L1EO"),n("HVwC"),n("JBxO"),n("FdtR"),n("QDHd");var a=n("uTJt"),o=n.n(a),l={page:1,apiKey:"89b9004c084fb7d0e8ffaadd17cb8254",total:0,getOneMovieInfo:function(e){var t="https://api.themoviedb.org/3/movie/"+e+"?api_key="+this.apiKey+"&language=en-US";return fetch(t).then((function(e){return e.json()}))},getPopularMovies:function(e){var t="https://api.themoviedb.org/3/movie/popular?api_key="+this.apiKey+"&language=en-US&page="+e+"&";return fetch(t).then((function(e){return e.json()}))},getMoviesBySearch:function(e){var t="https://api.themoviedb.org/3/search/movie?api_key="+this.apiKey+"&language=en-US&query="+e+"&page=1";return fetch(t).then((function(e){return e.json()}))},getGenre:function(){var e="https://api.themoviedb.org/3/genre/movie/list?api_key="+this.apiKey+"&language=en-US";return fetch(e).then((function(e){return e.json()})).then((function(e){return e.genres}))}},i={header:document.querySelector(".header"),nav:document.querySelector(".nav"),logo:document.querySelector(".logo"),home:document.querySelector("#home"),myLib:document.querySelector("#lib"),searchBox:document.querySelector(".search-box"),input:document.querySelector("#input"),notification:document.querySelector("#notification"),btnBox:document.querySelector(".btn-box"),gallery:document.querySelector(".movies-list"),container:document.querySelector(".container"),spinner:document.querySelector(".spinner-border"),error:document.querySelector("#error"),modal:document.querySelector("[data-modal]"),closeModalBtn:document.querySelector("[data-modal-close]"),movieCard:document.querySelector(".movie-card"),modalLib:document.querySelector("#modal-lib"),watchedBtn:document.querySelector("#watched"),queueBtn:document.querySelector("#queue"),mainPaginationContainer:document.getElementById("tui-pagination-container"),watchedPaginationContainer:document.getElementById("tui-pagination-container-watched"),info:document.querySelector("#info")};function r(){i.error.classList.remove("visually-hidden")}function c(){i.spinner.classList.add("visually-hidden")}function u(){i.spinner.classList.remove("visually-hidden"),i.error.classList.add("visually-hidden")}var s,d,m;n("RtS0"),n("WB5j"),n("3dw1"),n("IlJM"),n("D/wG"),n("wcNg");function p(e,t,n,a,o,l,i){try{var r=e[l](i),c=r.value}catch(e){return void n(e)}r.done?t(c):Promise.resolve(c).then(a,o)}function h(e){return e.forEach((function(e){return e.genre_ids=function(e){for(var t="",n=function(n){var a=e[n];if(n>1&&e.length>3)return t+="Other","break";t+=s.find((function(e){return e.id===a})).name,(0===n&&e.length>1||1===n&&e.length>2)&&(t+=", ")},a=0;a<e.length;a++){if("break"===n(a))break}return t}(e.genre_ids)})),e.forEach((function(e){return e.release_date=e.release_date.slice(0,4)})),e}function f(e,t){for(var n=0;n<=t;n++)e.pop();return e}function v(e){i.info.classList.add("visually-hidden"),u(),l.getPopularMovies(e).then((function(e){g(f(h(e.results),7))})).catch((function(){return r()})).finally((function(){return c()}))}function g(e){i.gallery.innerHTML=o()(e)}(d=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getGenre();case 2:s=e.sent;case 3:case"end":return e.stop()}}),e)})),m=function(){var e=this,t=arguments;return new Promise((function(n,a){var o=d.apply(e,t);function l(e){p(o,n,a,l,i,"next",e)}function i(e){p(o,n,a,l,i,"throw",e)}l(void 0)}))},function(){return m.apply(this,arguments)})(),v(),i.input.addEventListener("change",(function(e){e.preventDefault();var t=e.target.value;if(0==t)return;e.target.value="",u(),i.mainPaginationContainer.classList.add("is-none-pagination"),l.getMoviesBySearch(t).then((function(e){var t=h(e.results);if(20===t.length&&(t=f(t,7)),t.length)return i.notification.classList.add("visually-hidden"),g(e.results);i.notification.classList.remove("visually-hidden")})).catch((function(){return r()})).finally((function(){return c()}))}));var y=v,b=function(){i.home.classList.add("menu-link--curent"),i.myLib.classList.remove("menu-link--curent"),i.header.classList.add("header-home"),i.header.classList.remove("header-lib"),i.btnBox.classList.add("visually-hidden"),i.searchBox.classList.remove("visually-hidden"),i.mainPaginationContainer.classList.remove("is-none-pagination"),i.watchedPaginationContainer.classList.add("is-none-pagination")},w=function(){i.home.classList.remove("menu-link--curent"),i.myLib.classList.add("menu-link--curent"),i.header.classList.remove("header-home"),i.header.classList.add("header-lib"),i.btnBox.classList.remove("visually-hidden"),i.searchBox.classList.add("visually-hidden"),i.mainPaginationContainer.classList.add("is-none-pagination"),i.watchedPaginationContainer.classList.remove("is-none-pagination")},S=function(){i.modal.classList.toggle("is-hidden")},L=n("2c84"),q=n.n(L),x=(n("lUE2"),new q.a(i.mainPaginationContainer,{totalItems:1e4,itemsPerPage:20,visiblePages:5,page:1,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}));x.on("afterMove",(function(e){var t=e.page;y(t)}));var k=new q.a(i.watchedPaginationContainer,{totalItems:1,itemsPerPage:12,visiblePages:5,page:1,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"});k.on("afterMove",(function(e){var t=e.page;console.log("Я сообщаю текущую страницу пагинации для перерисовки следующего page в my library",t)})),i.nav.addEventListener("click",(function(e){e.preventDefault(),e.target===i.myLib?w():e.target===i.home&&(b(),y(),x.movePageTo(1),i.watchedBtn.classList.add("btn--accent"),i.queueBtn.classList.remove("btn--accent"))})),i.logo.addEventListener("click",(function(e){e.preventDefault(),b(),y(),x.movePageTo(1),i.watchedBtn.classList.add("btn--accent"),i.queueBtn.classList.remove("btn--accent")})),i.modalLib.addEventListener("click",(function(e){e.preventDefault(),S(),w()})),window.addEventListener("keyup",(function(){"Escape"===event.key&&S()}));n("IvQZ"),n("uQK7"),n("Xlt+"),n("fp7Y"),n("4NM0");var O=n("dcBu"),P=(n("PzF0"),n("wiOx")),_=n.n(P);function C(e){u(),l.getOneMovieInfo(e).then((function(e){i.movieCard.innerHTML=_()([e]),function(e){var t=JSON.parse(localStorage.getItem("add-watched")),n=JSON.parse(localStorage.getItem("add-queue")),a=document.querySelector(".watch-btn"),o=document.querySelector(".queue-btn"),l=[];"number"==typeof t?l.push(t):"object"==typeof t&&l.push.apply(l,t);a.addEventListener("click",(function(t){"add to watched"===t.target.textContent?(l.push(e),localStorage.setItem("add-watched",JSON.stringify(l)),E(e)):'remove  "watched"'===t.target.textContent&&(l.splice(l.indexOf(e),1),localStorage.setItem("add-watched",JSON.stringify(l)),E(e))}));var i=[];"number"==typeof n?i.push(n):"object"==typeof n&&i.push.apply(i,n);o.addEventListener("click",(function(t){"add to queue"===t.target.textContent?(i.push(e),localStorage.setItem("add-queue",JSON.stringify(i)),E(e)):'remove  "queue"'===t.target.textContent&&(i.splice(i.indexOf(e),1),localStorage.setItem("add-queue",JSON.stringify(i)),E(e))}))}(e.id)})).catch((function(){return r()})).finally((function(){return c()}))}function E(e){var t=JSON.parse(localStorage.getItem("add-watched")),n=JSON.parse(localStorage.getItem("add-queue")),a=document.querySelector(".watch-btn"),o=document.querySelector(".queue-btn");null!==t&&("number"==typeof t&&t===Number(e)||"object"==typeof t&&t.includes(Number(e))?a.textContent='remove  "watched"':a.textContent="add to watched"),null!==n&&n.includes(Number(e))?o.textContent='remove  "queue"':o.textContent="add to queue"}i.gallery.addEventListener("click",(function(e){e.preventDefault();var t=e.target;if("UL"===t.nodeName)return;S(),C(t.dataset.id),setTimeout(E,500,t.dataset.id)})),document.querySelector(".movie-card").addEventListener("click",(function(e){var t="https://api.themoviedb.org/3/movie/"+e.srcElement.dataset.id+"/videos?api_key=89b9004c084fb7d0e8ffaadd17cb8254&language=en-US";console.log(t),fetch(t).then((function(e){return e.json()})).then((function(e){var t=e.results[0].key;O.create('\n            <iframe src="https://www.youtube.com/embed/'+t+'" width="560" height="315" frameborder="0"></iframe>\n        ').show()}))})),i.closeModalBtn.addEventListener("click",S),null===localStorage.getItem("add-watched")&&localStorage.setItem("add-watched",JSON.stringify([])),null===localStorage.getItem("add-queue")&&localStorage.setItem("add-queue",JSON.stringify([]));n("iPZ8"),n("kypl"),n("pCzD"),n("4owi"),n("/YXa"),n("9UJh"),n("WoWj"),n("U00V");function I(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function j(e){i.gallery.innerHTML="",function(e){var t=JSON.parse(localStorage.getItem(e));!function(e){null!==e&&(k.setTotalItems(e.length),k.reset())}(t);for(var n,a=function(){var e=n.value,t=[];l.getOneMovieInfo(e).then((function(e){t.push(e),i.gallery.insertAdjacentHTML("beforeend",o()(t))}))},r=I(t);!(n=r()).done;)a()}(e)}i.myLib.addEventListener("click",(function(){return j("add-watched")})),i.watchedBtn.addEventListener("click",(function(){return j("add-watched")})),i.queueBtn.addEventListener("click",(function(){return j("add-queue")})),i.queueBtn.addEventListener("click",(function(){i.watchedBtn.classList.remove("btn--accent"),i.queueBtn.classList.add("btn--accent")})),i.watchedBtn.addEventListener("click",(function(){i.watchedBtn.classList.add("btn--accent"),i.queueBtn.classList.remove("btn--accent")}))},uTJt:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,o){var l,i,r=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,u="function",s=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="movies-list-item">\n  <div class="wrap">\n    '+(null!=(l=d(n,"if").call(r,null!=t?d(t,"poster_path"):t,{name:"if",hash:{},fn:e.program(2,o,0),inverse:e.program(4,o,0),data:o,loc:{start:{line:4,column:4},end:{line:10,column:11}}}))?l:"")+'  </div>\n  <h2 class="list-item-title" data-id="'+s(typeof(i=null!=(i=d(n,"id")||(null!=t?d(t,"id"):t))?i:c)===u?i.call(r,{name:"id",hash:{},data:o,loc:{start:{line:12,column:39},end:{line:12,column:45}}}):i)+'">'+s(typeof(i=null!=(i=d(n,"title")||(null!=t?d(t,"title"):t))?i:c)===u?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:12,column:47},end:{line:12,column:56}}}):i)+'</h2>\n  <p class="list-item-descr" data-id="'+s(typeof(i=null!=(i=d(n,"id")||(null!=t?d(t,"id"):t))?i:c)===u?i.call(r,{name:"id",hash:{},data:o,loc:{start:{line:13,column:38},end:{line:13,column:44}}}):i)+'">'+s(typeof(i=null!=(i=d(n,"genre_ids")||(null!=t?d(t,"genre_ids"):t))?i:c)===u?i.call(r,{name:"genre_ids",hash:{},data:o,loc:{start:{line:13,column:46},end:{line:13,column:59}}}):i)+" | "+s(typeof(i=null!=(i=d(n,"release_date")||(null!=t?d(t,"release_date"):t))?i:c)===u?i.call(r,{name:"release_date",hash:{},data:o,loc:{start:{line:13,column:62},end:{line:13,column:78}}}):i)+' <span class="list-item-vote_average">\n      '+s(typeof(i=null!=(i=d(n,"vote_average")||(null!=t?d(t,"vote_average"):t))?i:c)===u?i.call(r,{name:"vote_average",hash:{},data:o,loc:{start:{line:14,column:6},end:{line:14,column:22}}}):i)+" </span></p>\n</li>\n"},2:function(e,t,n,a,o){var l,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' <img class="list-item-img" src="https://image.tmdb.org/t/p/w300/'+c("function"==typeof(l=null!=(l=u(n,"poster_path")||(null!=t?u(t,"poster_path"):t))?l:r)?l.call(i,{name:"poster_path",hash:{},data:o,loc:{start:{line:4,column:88},end:{line:4,column:103}}}):l)+'" alt="Movie"\n      data-id="'+c("function"==typeof(l=null!=(l=u(n,"id")||(null!=t?u(t,"id"):t))?l:r)?l.call(i,{name:"id",hash:{},data:o,loc:{start:{line:5,column:15},end:{line:5,column:21}}}):l)+'" />\n'},4:function(e,t,n,a,o){var l,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <img class="list-item-img"\n      src="https://motivatevalmorgan.com/wp-content/uploads/2016/06/default-movie-1-1-300x450.jpg" alt="Movie"\n      data-id="'+e.escapeExpression("function"==typeof(l=null!=(l=i(n,"id")||(null!=t?i(t,"id"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"id",hash:{},data:o,loc:{start:{line:9,column:15},end:{line:9,column:21}}}):l)+'" />\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,o){var l;return null!=(l=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:16,column:9}}}))?l:""},useData:!0})},wiOx:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,o){var l,i,r=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,u="function",s=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="card-box">\n    <div class="box-image">\n        <img class="one-movie-image" src="https://image.tmdb.org/t/p/w400/'+s(typeof(i=null!=(i=d(n,"poster_path")||(null!=t?d(t,"poster_path"):t))?i:c)===u?i.call(r,{name:"poster_path",hash:{},data:o,loc:{start:{line:4,column:74},end:{line:4,column:89}}}):i)+'" alt="Poster">\n    </div>\n    <div class="box-content">\n        <h2 class="content-title">'+s(typeof(i=null!=(i=d(n,"title")||(null!=t?d(t,"title"):t))?i:c)===u?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:7,column:34},end:{line:7,column:43}}}):i)+'</h2>\n        <ul class="content-list">\n            <li class="content-item">\n                <p class="item-part">Vote / Votes </p>\n                <span class="item-data item-data--accent">'+s(typeof(i=null!=(i=d(n,"vote_average")||(null!=t?d(t,"vote_average"):t))?i:c)===u?i.call(r,{name:"vote_average",hash:{},data:o,loc:{start:{line:11,column:58},end:{line:11,column:74}}}):i)+'</span><span> / </span>\n                <span class="item-data item-data--accent item-data--grey">'+s(typeof(i=null!=(i=d(n,"vote_count")||(null!=t?d(t,"vote_count"):t))?i:c)===u?i.call(r,{name:"vote_count",hash:{},data:o,loc:{start:{line:12,column:74},end:{line:12,column:88}}}):i)+'</span>\n            </li>\n            <li class="content-item">\n                <p class="item-part">Popularity</p> <span class="item-data">'+s(typeof(i=null!=(i=d(n,"popularity")||(null!=t?d(t,"popularity"):t))?i:c)===u?i.call(r,{name:"popularity",hash:{},data:o,loc:{start:{line:16,column:76},end:{line:16,column:90}}}):i)+'</span>\n\n            </li>\n            <li class="content-item">\n                <p class="item-part">Original Title</p> <span class="item-data">'+s(typeof(i=null!=(i=d(n,"original_title")||(null!=t?d(t,"original_title"):t))?i:c)===u?i.call(r,{name:"original_title",hash:{},data:o,loc:{start:{line:20,column:80},end:{line:20,column:98}}}):i)+'</span>\n\n            </li>\n            <li class="content-item">\n                <p class="item-part">Genre\n                <ul class="genre-list">\n'+(null!=(l=d(n,"each").call(r,null!=t?d(t,"genres"):t,{name:"each",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:26,column:20},end:{line:28,column:29}}}))?l:"")+'                </ul>\n                </p>\n\n            </li>\n        </ul>\n        <h3 class="title-text">About</h3>\n        <p class="text">'+s(typeof(i=null!=(i=d(n,"overview")||(null!=t?d(t,"overview"):t))?i:c)===u?i.call(r,{name:"overview",hash:{},data:o,loc:{start:{line:35,column:24},end:{line:35,column:36}}}):i)+'</p>\n        <div class="box-btn">\n            <button id="add-watched" class="btn watch-btn" data-source=\'add-watched\'>add to Watched</button>\n            <button id="add-queue" class="btn queue-btn" data-source=\'add-queue\'>add to queue</button>\n            <button id="trailer" data-id="'+s(typeof(i=null!=(i=d(n,"id")||(null!=t?d(t,"id"):t))?i:c)===u?i.call(r,{name:"id",hash:{},data:o,loc:{start:{line:39,column:42},end:{line:39,column:48}}}):i)+'" class="btn trailer-btn" data-source=\'trailer\'>watch trailer</button>\n        </div>\n    </div>\n</div>\n'},2:function(e,t,n,a,o){var l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                    <li class="item-data genre-data">'+e.escapeExpression(e.lambda(null!=t?l(t,"name"):t,t))+"</li>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,o){var l;return null!=(l=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:43,column:9}}}))?l:""},useData:!0})}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.7fed2e18b8d1bcaf6405.js.map